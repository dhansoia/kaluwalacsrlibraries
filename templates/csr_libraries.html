{% extends "base.html" %}
{% block title %}Manage Libraries - CSR Admin{% endblock %}
{% block extra_css %}
<style>
.csr-container{max-width:1600px;margin:0 auto}.csr-header{background:linear-gradient(135deg,#1e3a8a 0%,#3b82f6 100%);color:#fff;border-radius:15px;padding:30px;margin-bottom:30px;box-shadow:0 8px 30px rgba(0,0,0,.3)}.csr-title{font-size:2rem;margin-bottom:10px;font-weight:700}.library-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px;margin-bottom:30px}.library-card{background:#fff;border-radius:15px;padding:25px;box-shadow:0 4px 15px rgba(0,0,0,.1);transition:transform .2s}.library-card:hover{transform:translateY(-5px)}.library-name{color:#1e3a8a;font-size:1.5rem;font-weight:700;margin-bottom:10px}.library-location{color:#666;margin-bottom:15px}.stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:15px 0;padding:15px 0;border-top:2px solid #e5e7eb;border-bottom:2px solid #e5e7eb}.stat-item{text-align:center}.stat-value{font-size:1.8rem;font-weight:700;color:#1e3a8a}.stat-label{font-size:.85rem;color:#666}.seat-control{background:#f9fafb;padding:15px;border-radius:8px;margin:15px 0}.seat-control label{display:block;font-weight:600;margin-bottom:8px;color:#333}.seat-input{display:flex;gap:10px;align-items:center}.seat-input input{flex:1;padding:10px;border:2px solid #e5e7eb;border-radius:6px;font-size:1rem}.btn{padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer;border:none;transition:all .3s;text-decoration:none;display:inline-block}.btn-primary{background:#3b82f6;color:#fff}.btn-primary:hover{background:#1e3a8a}.btn-success{background:#10b981;color:#fff}.btn-success:hover{background:#059669}.btn-danger{background:#ef4444;color:#fff}.btn-danger:hover{background:#dc2626}.btn-sm{padding:6px 12px;font-size:.9rem}.actions{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap}.alert{padding:12px 16px;border-radius:8px;margin-bottom:20px;font-weight:500}.alert-info{background:#dbeafe;color:#1e40af;border-left:4px solid #3b82f6}.back-btn{margin-bottom:20px}
</style>
{% endblock %}
{% block content %}
<div class="csr-container">
<div class="back-btn">
<a href="/csr-admin" class="btn btn-primary">‚Üê Back to Dashboard</a>
</div>
<div class="csr-header">
<h1 class="csr-title">üè¢ Manage All Libraries</h1>
<p style="font-size:1.1rem;opacity:.9">View and manage seat allocations for each library</p>
</div>
<div class="alert alert-info">
üí° <strong>Tip:</strong> You can add or remove seats for any library. New seats will be created as general category by default.
</div>
<div class="library-grid">
{% for library in libraries %}
<div class="library-card">
<div class="library-name">{{ library.name }}</div>
<div class="library-location">üìç {{ library.city }}, {{ library.state }}</div>
<div class="stats-row">
<div class="stat-item">
<div class="stat-value">{{ library_stats[library.id].total_seats }}</div>
<div class="stat-label">Total Seats</div>
</div>
<div class="stat-item">
<div class="stat-value">{{ library_stats[library.id].total_bookings }}</div>
<div class="stat-label">Total Bookings</div>
</div>
<div class="stat-item">
<div class="stat-value">{{ library_stats[library.id].active_bookings }}</div>
<div class="stat-label">Active</div>
</div>
</div>
<div class="seat-control">
<form method="POST" action="/csr-admin/libraries/{{ library.id }}/update-seats">
<label>Adjust Seat Capacity</label>
<div class="seat-input">
<input type="number" name="total_seats" value="{{ library_stats[library.id].total_seats }}" min="10" max="500" required>
<button type="submit" class="btn btn-success btn-sm">Update</button>
</div>
<small style="color:#666;margin-top:5px;display:block">Current: {{ library_stats[library.id].total_seats }} seats (Range: 10-500)</small>
</form>
</div>
<div class="seat-control" style="margin-top:15px;background:#f0f9ff;border:2px solid #3b82f6">
<form method="POST" action="/csr-admin/libraries/{{ library.id }}/update-reservations">
<label style="color:#1e3a8a">üî¨ Reserved Seat Allocation</label>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
<div>
<label style="font-size:.85rem;color:#7c3aed;font-weight:600">For Researchers</label>
<input type="number" name="researcher_seats" value="{{ library_stats[library.id].researcher_seats }}" min="0" max="{{ library_stats[library.id].total_seats }}" class="form-input" style="padding:8px;border:2px solid #7c3aed">
</div>
<div>
<label style="font-size:.85rem;color:#db2777;font-weight:600">For Staff</label>
<input type="number" name="staff_seats" value="{{ library_stats[library.id].staff_seats }}" min="0" max="{{ library_stats[library.id].total_seats }}" class="form-input" style="padding:8px;border:2px solid #db2777">
</div>
</div>
<button type="submit" class="btn btn-primary btn-sm" style="width:100%;background:#3b82f6">Update Reservations</button>
<small style="color:#1e3a8a;margin-top:5px;display:block;font-weight:600">Reserved: {{ library_stats[library.id].researcher_seats + library_stats[library.id].staff_seats }} / {{ library_stats[library.id].total_seats }} seats</small>
</form>
</div>
<div class="actions">
<a href="/admin/{{ library.slug }}" class="btn btn-primary btn-sm">üõ†Ô∏è Manage</a>
<a href="/csr-admin/libraries/{{ library.id }}/edit" class="btn btn-primary btn-sm">‚úèÔ∏è Edit Details</a>
<form method="POST" action="/csr-admin/libraries/{{ library.id }}/delete" style="display:inline" onsubmit="return confirm('Are you sure? This will delete all seats and bookings!')">
<button type="submit" class="btn btn-danger btn-sm">üóëÔ∏è Delete</button>
</form>
</div>
</div>
{% endfor %}
</div>
<div style="text-align:center;margin-top:30px">
<a href="/csr-admin/libraries/create" class="btn btn-success" style="padding:15px 30px;font-size:1.1rem">‚ûï Create New Library</a>
</div>
</div>
{% endblock %}
